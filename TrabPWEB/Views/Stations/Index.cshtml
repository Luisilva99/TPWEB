@model IEnumerable<TrabPWEB.DAL.Station>

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table class="table table-hover table-striped w-auto">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.StationName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Local.LocalName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Start)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Finnish)
        </th>
        <th>
            <b>Postos de Carregamento</b>
        </th>
        <th></th>
    </tr>

@foreach (TrabPWEB.DAL.Station item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.StationName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Local.LocalName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Start)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Finnish)
        </td>
        <td>
            <table class="table table-hover table-striped w-auto">
                <tr>
                    <th>
                        <b> Posto </b>
                    </th>
                    <th>
                        <b> Tipo de Carregamento </b>
                    </th>
                    <th>
                        <b> Horas </b>
                    </th>
                    <th></th>
                </tr>
                @foreach (TrabPWEB.DAL.StationPost itemPosto in ((TrabPWEB.Controllers.StationsController)this.ViewContext.Controller).getPostos(item.StationId))
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItemPost => itemPosto.StationPostName)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItemPost => itemPosto.RechargeType.RechargeTypeName)
                        </td>
                        <td class="dropdown">
                            <p class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" style="color:blue">Horas &#9660;</p>
                            <div class="dropdown-menu table-responsive" style="max-height:300px">
                                <table class="dropdown-item table table-hover table-striped w-auto">
                                    <tr class="dropdown-item">
                                        <th>
                                            <b>Horas</b>
                                        </th>
                                        <th>
                                            <b>Disponibilidade</b>
                                        </th>
                                    </tr>
                                    @foreach (TrabPWEB.DAL.TimeData itemTime in ((TrabPWEB.Controllers.StationsController)this.ViewContext.Controller).getStationTimes(itemPosto.StationPostId))
                                    {
                                        <tr class="dropdown-item">
                                            <td>
                                                @Html.DisplayFor(modelItemTime => itemTime.Time, "{0:HH:mm}")
                                            </td>
                                            <td>
                                                @if (itemTime.Status)
                                                {
                                                    <p>Disponível</p>
                                                }
                                                else
                                                {
                                                    <p>Indisponível</p>
                                                }
                                            </td>
                                        </tr>
                                    }
                                </table>
                            </div>
                        </td>
                    </tr>
                }
            </table>
        </td>
        <td>
            @Html.ActionLink("Adicionar novo Posto", "AddPost", new { id = item.StationId }) |
            @Html.ActionLink("Edit", "Edit", new { id = item.StationId }) |
            @Html.ActionLink("Details", "Details", new { id = item.StationId }) |
            @Html.ActionLink("Delete", "Delete", new { id = item.StationId })
        </td>
    </tr>
}

</table>
